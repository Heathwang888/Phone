<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>手機對保正式版合約</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: 'Noto Sans TC', sans-serif; padding: 20px; }
    .contract-page { width: 210mm; height: 297mm; padding: 25mm; background: white; margin-bottom: 20px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    h2 { text-align: center; margin-bottom: 20px; }
    p { margin: 6px 0; text-align: justify; }
    .page-break { page-break-after: always; }
    .section-title { font-weight: bold; margin-top: 20px; }
  </style>
</head>

<body>

<h1>手機對保資料填寫</h1>

<!-- 表單開始 -->
<form id="dataForm">
  客戶姓名：<input type="text" id="name"><br><br>
  身分證字號：<input type="text" id="id"><br><br>
  地址：<input type="text" id="address"><br><br>
  IMEI碼：<input type="text" id="imei"><br><br>
  金額（交易總價）（元）：<input type="number" id="price"><br><br>
  每日租金（元）：<input type="number" id="rent"><br><br>
  行庫分行：<input type="text" id="bank"><br><br>
  戶名：<input type="text" id="accountName"><br><br>
  帳號：<input type="text" id="accountNumber"><br><br>

  手機型號：
  <select id="model">
    <option>iPhone 12</option><option>iPhone 12 mini</option><option>iPhone 12 Pro</option><option>iPhone 12 Pro Max</option>
    <option>iPhone 13</option><option>iPhone 13 mini</option><option>iPhone 13 Pro</option><option>iPhone 13 Pro Max</option>
    <option>iPhone 14</option><option>iPhone 14 Plus</option><option>iPhone 14 Pro</option><option>iPhone 14 Pro Max</option>
    <option>iPhone 15</option><option>iPhone 15 Plus</option><option>iPhone 15 Pro</option><option>iPhone 15 Pro Max</option>
    <option>iPhone 16</option><option>iPhone 16 Plus</option><option>iPhone 16 Pro</option><option>iPhone 16 Pro Max</option>
    <option>iPhone 16E</option>
  </select><br><br>

  容量：
  <select id="capacity">
    <option>128G</option><option>256G</option><option>512G</option><option>1TB</option>
  </select><br><br>

  <button type="button" onclick="generateContract()">產生PDF合約</button>
</form>

<!-- 合約內容區開始 -->
<div id="contractContent" style="display:none">
<!-- 手機買賣契約頁面 -->
<div class="contract-page" id="page1">
  <h2>中古手機買賣契約</h2>

  <p class="section-title">出賣人資料</p>
  <p>姓名：<span id="outName"></span>　身分證字號：<span id="outId"></span></p>
  <p>地址：<span id="outAddress"></span></p>

  <p class="section-title">標的物</p>
  <p>手機廠牌：APPLE</p>
  <p>手機型號：<span id="outModel"></span>　容量：<span id="outCapacity"></span>　IMEI碼：<span id="outImei"></span></p>

  <p class="section-title">第一條 標的物現況</p>
  <p>1. 出賣人出售標的物現況如下：</p>
  <p>（一）功能正常 ■是 □否</p>
  <p>（二）外觀無重大瑕疵 ■是 □否</p>
  <p>（三）是否有動產抵押及其他負擔：■無 □有（債權人：________ 抵押金額：________）</p>

  <p class="section-title">第二條 價金與支付</p>
  <p>1. 交易總價：新台幣<span id="outPrice"></span>元整。</p>
  <p>2. 買受人以匯款方式支付至下列帳戶：</p>
  <p>行庫分行：<span id="outBank"></span></p>
  <p>戶名：<span id="outAccountName"></span></p>
  <p>帳號：<span id="outAccountNumber"></span></p>

  <p class="section-title">第三條 交付與占有</p>
  <p>出賣人與買受人約定以民法第761條占有改定方式交付標的物。</p>

  <p class="section-title">第四條 保固責任</p>
  <p>標的物係以現況交付，出賣人不負瑕疵擔保責任。</p>

  <p class="section-title">第五條 其他約定事項</p>
  <p>（一）出賣人保證標的物非贓物且無其他權利瑕疵。</p>
  <p>（二）出賣人保證標的物未曾經重大損壞或改裝。</p>
  <p>（三）標的物利益及危險，自交付時起由買受人承受。</p>
  <p>（四）本契約未盡事項，雙方本誠信原則協議之。</p>
  <p>（五）雙方同意以電子方式簽署本契約。</p>
  <p>（六）本契約書一式貳份，雙方各執一份為憑。</p>
  <p>（七）本契約發生爭議，以台灣高雄地方法院為第一審管轄法院。</p>

  <br><br>

  <p>立契約書人：</p>
  <p>出賣人：<span id="outNameSign"></span>（簽章）</p>
  <p>身分證字號：<span id="outIdSign"></span></p>

  <br><br>
  <p style="text-align: right;">立約日期：<span id="outDate"></span></p>

</div>
<!-- 手機租賃契約頁面 -->
<div class="contract-page page-break" id="page2">
  <h2>手機租賃契約書</h2>

  <p class="section-title">承租人資料</p>
  <p>姓名：<span id="rentName"></span>　身分證字號：<span id="rentId"></span></p>
  <p>地址：<span id="rentAddress"></span></p>

  <p class="section-title">出租人資料</p>
  <p>姓名：【留空】　身分證字號：【留空】　地址：【留空】</p>

  <p class="section-title">第一條 租賃標的</p>
  <p>1. 出租人同意將下列標的出租予承租人使用：</p>
  <p>手機廠牌：APPLE　型號：<span id="rentModel"></span>　容量：<span id="rentCapacity"></span>　IMEI碼：<span id="rentImei"></span></p>
  <p>總價值：新台幣<span id="rentPrice"></span>元整。</p>

  <p class="section-title">第二條 租賃期間</p>
  <p>租賃期間自 <span id="rentStart"></span> 起至 <span id="rentEnd"></span> 止。</p>

  <p class="section-title">第三條 租金及支付方式</p>
  <p>1. 每日租金為新台幣<span id="rentDayPrice"></span>元整。</p>
  <p>2. 每期租金應於租期開始時一次繳清。</p>

  <p class="section-title">第四條 使用限制</p>
  <p>1. 承租人應善良管理並依正常方式使用租賃標的，不得改裝、轉租、轉借、或以任何方式處分或為擔保。</p>

  <p class="section-title">第五條 維修責任</p>
  <p>1. 租賃期間內，非因自然損耗致標的損壞者，由承租人負責修復或負擔損害賠償責任。</p>

  <p class="section-title">第六條 遺失及毀損</p>
  <p>1. 承租人應負責保管租賃標的，如有遺失、毀損而無法修復時，應按總價值賠償出租人。</p>

  <p class="section-title">第七條 返還義務</p>
  <p>1. 承租人應於租賃期間屆滿時，返還租賃標的。</p>
  <p>2. 逾期未返還時，承租人仍應支付租金至實際返還之日止，並賠償因此所生之一切損害。</p>

  <p class="section-title">第八條 特別約定</p>
  <p>1. 如承租人有逾期未還、租金欠繳等違約情事，出租人得遠端鎖定或關閉設備，承租人不得異議。</p>
  <p>2. 若承租人欲購買租賃標的，可與出租人另行議定價格與條件。</p>

  <p class="section-title">第九條 爭議處理</p>
  <p>雙方同意，如有任何爭議，應以台灣高雄地方法院為第一審管轄法院。</p>

  <p class="section-title">第十條 契約份數</p>
  <p>本契約書一式貳份，雙方各執一份為憑。</p>

  <p class="section-title">第十一條 電子簽署</p>
  <p>雙方同意以電子方式簽署本契約，具同等法律效力。</p>

  <br><br>

  <p>立契約書人：</p>
  <p>承租人（甲方）：<span id="rentNameSign"></span>（簽章）</p>
  <p>出租人（乙方）：【留空】</p>
  <p>中 華 民 國　<span id="rentSignDate"></span></p>
</div>
<!-- 切結書頁面 -->
<div class="contract-page page-break" id="page3">
  <h2>切結書</h2>

  <p>立書人（下稱本人）：<span id="swearName"></span></p>
  <p>身分證字號：<span id="swearId"></span></p>
  <p>地址：<span id="swearAddress"></span></p>

  <br>

  <p>本人茲為下列事項，向【公司名稱】（以下簡稱貴公司）切結如下：</p>

  <p>一、本人提供之所有身分證明文件、住址及聯絡方式等資料，均為真實且有效，絕無虛偽不實。</p>

  <p>二、本人所出售或出租予貴公司之手機設備，來源正當，無失竊、贓物、訴訟保全、查封或任何權利負擔情事。</p>

  <p>三、本人確認出售/出租手機時，設備型號、容量、IMEI碼、外觀及功能狀態，皆已確實說明，不隱瞞。</p>

  <p>四、本人知悉如有隱瞞、不實陳述，將負全部民事、刑事責任，並同意賠償貴公司因此受有之一切損害。</p>

  <p>五、本人同意，如因上述原因致貴公司受損時，貴公司得單方終止買賣或租賃契約，並向本人求償所有損害及衍生費用（包含但不限於：律師費、訴訟費、強制執行費）。</p>

  <p>六、本人理解並同意本切結書經電子簽署後，具有與親筆簽名同等法律效力。</p>

  <br><br>

  <p>立書人：<span id="swearNameSign"></span>（簽章）</p>
  <p>身分證字號：<span id="swearIdSign"></span></p>
  <p>地址：<span id="swearAddressSign"></span></p>
  <br>
  <p style="text-align: right;">中 華 民 國　<span id="swearDate"></span></p>

</div>
<!-- 合約內容結束 -->
</div>

<!-- JS開始 -->
<script>
// 民國日期轉換
function toTaiwanDate(date) {
  const year = date.getFullYear() - 1911;
  const month = (date.getMonth() + 1).toString().padStart(2, '0');
  const day = date.getDate().toString().padStart(2, '0');
  return `民國${year}年${month}月${day}日`;
}

async function generateContract() {
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF('p', 'mm', 'a4');
  const today = new Date();
  const endDate = new Date(); endDate.setDate(today.getDate() + 7);

  // 取得表單資料
  const name = document.getElementById('name').value;
  const id = document.getElementById('id').value;
  const address = document.getElementById('address').value;
  const imei = document.getElementById('imei').value;
  const price = document.getElementById('price').value;
  const rent = document.getElementById('rent').value;
  const model = document.getElementById('model').value;
  const capacity = document.getElementById('capacity').value;
  const bank = document.getElementById('bank').value;
  const accountName = document.getElementById('accountName').value;
  const accountNumber = document.getElementById('accountNumber').value;

  // 賦值到契約中
  document.getElementById('outName').innerText = name;
  document.getElementById('outId').innerText = id;
  document.getElementById('outAddress').innerText = address;
  document.getElementById('outModel').innerText = model;
  document.getElementById('outCapacity').innerText = capacity;
  document.getElementById('outImei').innerText = imei;
  document.getElementById('outPrice').innerText = price;
  document.getElementById('outBank').innerText = bank;
  document.getElementById('outAccountName').innerText = accountName;
  document.getElementById('outAccountNumber').innerText = accountNumber;
  document.getElementById('outNameSign').innerText = name;
  document.getElementById('outIdSign').innerText = id;
  document.getElementById('outDate').innerText = toTaiwanDate(today);

  document.getElementById('rentName').innerText = name;
  document.getElementById('rentId').innerText = id;
  document.getElementById('rentAddress').innerText = address;
  document.getElementById('rentModel').innerText = model;
  document.getElementById('rentCapacity').innerText = capacity;
  document.getElementById('rentImei').innerText = imei;
  document.getElementById('rentPrice').innerText = price;
  document.getElementById('rentStart').innerText = toTaiwanDate(today);
  document.getElementById('rentEnd').innerText = toTaiwanDate(endDate);
  document.getElementById('rentDayPrice').innerText = rent;
  document.getElementById('rentNameSign').innerText = name;
  document.getElementById('rentSignDate').innerText = toTaiwanDate(today);

  document.getElementById('swearName').innerText = name;
  document.getElementById('swearId').innerText = id;
  document.getElementById('swearAddress').innerText = address;
  document.getElementById('swearNameSign').innerText = name;
  document.getElementById('swearIdSign').innerText = id;
  document.getElementById('swearAddressSign').innerText = address;
  document.getElementById('swearDate').innerText = toTaiwanDate(today);

  // PDF生成
  const pages = document.querySelectorAll('.contract-page');
  for (let i = 0; i < pages.length; i++) {
    const canvas = await html2canvas(pages[i]);
    const imgData = canvas.toDataURL('image/jpeg');
    const imgProps = pdf.getImageProperties(imgData);
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
    if (i > 0) pdf.addPage();
    pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
  }
  pdf.save(`${name}-手機對保合約.pdf`);
}
</script>

</body>
</html>
